{% extends 'report/layouts/base.html' %}
{% import 'report/components/overview.html' as overview %}
{% import 'report/components/important_metrics.html' as important_metrics %}
{% import 'report/components/transcript_stats.html' as transcript_stats %}
{% import 'report/components/explanations.html' as explanations %}
{% import 'report/components/form.html' as form %}

{% block nav %}
	{% if '/group' in request.path %}
		<li>
			{{ form.report_form(customizations, group_id, pdf=True, hidden=True) }}
		</li>
	{% endif %}
{% endblock %}

{% block main %}

	<div class="container">
		<div class="panel-group hidden-print" id="filter-accordion">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h4 class="panel-title">
						<a role="button" data-toggle="collapse" data-parent="#accordion" href="#view-filters">Customize</a>
					</h4>
				</div>

				<div id="view-filters" class="panel-collapse collapse">
					<div class="panel-body">
						{{ form.report_form(customizations, group_id, levels=levels|map('first')) }}
					</div>
				</div>
			</div>
		</div>

		<h2>{{ _('Quality report') }}: {{ _('clinical sequencing') }}</h2>
		{% if customizations.panel_name %}
			<p>{{ _('Based on gene panel') }}: <strong>{{ customizations.panel_name }}</strong></p>
		{% endif %}
		{{ overview.table(samples, genders, customizations.id_map) }}

		<h3>
			{{ _('Generally important metrics') }}
    	</h3>
    	{{ important_metrics.table(key_metrics, customizations.id_map, levels, customizations.level) }}
		

		<h3>
			{{ _('Transcript coverage') }} {{ _('at') }}: {{ customizations.level }}x
		</h3>
		{{ transcript_stats.table(diagnostic_yield, customizations.id_map, show_genes=customizations.show_genes) }}

		<h3>{{ _('Explanations') }}</h3>
		{{ explanations.text(customizations.level) }}

		<hr>
		<div class="text-center">{{ _('End of report') }}</div>
	</div>

{% endblock %}

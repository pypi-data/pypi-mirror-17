import numpy as np

sub = np.arange(4, 41, 8)
full = np.arange(41)


def intervals(sub, full):
    res = np.zeros(full.shape)
    lines = np.zeros(full.shape)
    for i, col in enumerate(sub[:-1]):
        if i == 0:
            start_col = 0
        else:
            start_col = col
        if i == len(sub) - 2:
            end_col = len(full)
        else:
            end_col = sub[i + 1]
        # print "===", i, col
        for j in full[start_col:end_col]:
            # print j, (j - col) * 1.0 / (sub[i + 1] - col)
            res[j] = (j - col) * 1.0 / (sub[i + 1] - col)
            lines[j] = i
    return res, lines

print intervals(sub, full)


def slerp_interp_cols(lons, lats, cols_subset, cols_full):
    print cols_full, cols_subset
    t = np.zeros(cols_full.shape, dtype=np.float)
    first_idx = len(cols_subset)
    for i, val in enumerate(cols_full):
        if val > cols_subset[0]:
            first_idx = i
            break
    t[:first_idx] = (cols_full[:first_idx] - cols_subset[0]) / \
        (cols_subset[1] - cols_subset[0] * 1.0)
    print t
    last_idx = 0
    for i, val in enumerate(reversed(cols_full)):
        if val < cols_subset[-1]:
            last_idx = i
            break
    t[-last_idx:] = (cols_full[-last_idx:] - cols_subset[-1]) / \
        (cols_subset[-2] - cols_subset[-1] * 1.0)
    print t


a = [23616.383027977939, 22849.379264144311, 22130.954874319305,
     21456.522314502246, 20822.069456824782, 20224.070461650877,
     19659.41291665881, 19125.337876705849, 18619.390167876838,
     18139.376951497208, 17683.332979954303, 17249.491305140749,
     16836.258439327543, 16442.193225402072, 16065.988742019546,
     15706.456777447296, 15362.514418658466, 15033.172454937152,
     14717.525296703147, 14414.742172486702, 14124.059450297436,
     13844.773877096006, 13576.236638619155, 13317.848111884623,
     13069.053224179403, 12829.3373339466, 12598.222552996796,
     12375.264492582279, 12160.049322912129, 11952.191169306587,
     11751.329752271522, 11557.128277732068, 11369.271524214979,
     11187.464126266286, 11011.42902046726, 10840.906021609437,
     10675.650554432184, 10515.432481200547, 10360.035040758414,
     10209.253881048702, 10062.896180173215, 9920.7798251317472,
     9782.732681796535, 9648.5919158068118, 9518.2033543250618,
     9391.4209277975333, 9268.1061317260446, 9148.1275441933431,
     9031.3603695866641, 8917.6860349646558, 8806.9917867966506,
     8699.1703522568732, 8594.1196028816776, 8491.7422451882685,
     8391.9455415113298, 8294.6410391412264, 8199.7443346581349,
     8107.1748327369223, 8016.8555401205413, 7928.7128659479749,
     7842.6764315656774, 7758.6789004014881, 7676.6558157531363,
     7596.5454446863268, 7518.2886373172423, 7441.8286985732639,
     7367.111250196851, 7294.0841274337108, 7222.6972592298598,
     7152.902565040913, 7084.6538622174248, 7017.9067690702368,
     6952.6186218177709, 6888.7483858925507, 6826.256590064233,
     6765.105244624955, 6705.2577774064503, 6646.6789642927988,
     6589.3348760331883, 6533.1928135865564, 6478.2212518095203,
     6424.3897991284757, 6371.6691308151203, 6320.0309592994799,
     6269.4479807259686, 6219.8938317327211, 6171.3430585380629,
     6123.7710705655236, 6077.154107997706, 6031.4692089739492,
     5986.6941744979968, 5942.8075398434621, 5899.7885444951862,
     5857.6171013035573, 5816.2737795118619, 5775.7397669053453,
     5735.9968520799312, 5697.0274047598332, 5658.8143447059683,
     5621.3411333489803, 5584.5917379433731, 5548.5506304974188,
     5513.2027510052831, 5478.5335091223114, 5444.5287489426091,
     5411.1747458683121, 5378.4581910540228, 5346.3661662459863,
     5314.8861418636679, 5284.0059574981915, 5253.7138104098412,
     5223.998242616859, 5194.8481294811036, 5166.2526738444685,
     5138.2013821505607, 5110.6840687776776, 5083.6908373576134,
     5057.212073848973, 5031.2384347000434, 5005.7608485667524,
     4980.7704890230416, 4956.2587842588409, 4932.2174019279237,
     4908.6382404362694, 4885.5134257638356, 4862.8353000107163,
     4840.5964194601984, 4818.7895429886375, 4797.4076337691768,
     4776.4438423403153, 4755.891514981221, 4735.7441718881591,
     4715.9955168450524, 4696.6394240091922, 4677.6699319912013,
     4659.0812489832924, 4640.8677327922123, 4623.023901357702,
     4605.5444207233995, 4588.4240998902114, 4571.6578933621586,
     4555.2408910126378, 4539.1683203014964, 4523.4355339621061,
     4508.0380183655616, 4492.9713800144409, 4478.2313468513103,
     4463.8137712547841, 4449.7146105512193, 4435.9299430895862,
     4422.455951481058, 4409.2889316456904, 4396.4252762526639,
     4383.8614883055543, 4371.5941654261233, 4359.6200053704379,
     4347.9357984344733, 4336.5384347265799, 4325.4248886582163,
     4314.592227071349, 4304.0376082468438, 4293.7582687772747,
     4283.7515357090033, 4274.0148157751491, 4264.545597121798,
     4255.3414460633703, 4246.400008924732, 4237.719007454205,
     4229.2962362403714, 4221.129566635328, 4213.2169421659046,
     4205.5563752873168, 4198.1459479706036, 4190.9838165636565,
     4184.0681977236336, 4177.3973785164826, 4170.9697144869215,
     4164.783619447835, 4158.8375763670683, 4153.1301289489938,
     4147.6598838007976, 4142.425506327565, 4137.4257284584, 4132.659334793816,
     4128.1251723816476, 4123.8221496303158, 4119.7492278065538,
     4115.9054287972967, 4112.2898280440122, 4108.9015630786771,
     4105.7398204344508, 4102.8038448928701, 4100.0929391418867,
     4097.6064552367961, 4095.3438029327922, 4093.30444294166,
     4091.4878927838449, 4089.8937212022693, 4088.5215504025173,
     4087.3710554750892, 4086.4419642926068, 4085.7340575630255,
     4085.2471664220416, 4084.9811773685174, 4084.9360271872083,
     4085.1117057798297, 4085.5082532246101, 4086.1257649365125,
     4086.9643870340965, 4088.0243164930303, 4089.30580575459,
     4090.8091578864951, 4092.5347297639951, 4094.4829285143874,
     4096.6542202690007, 4099.0491162866001, 4101.6681918342119,
     4104.5120659377781, 4107.5814176753556, 4110.8769808615161,
     4114.3995429113083, 4118.1499473540971, 4122.1290932875827,
     4126.3379389377224, 4130.7774943999866, 4135.4488332608689,
     4140.3530830008722, 4145.4914313227027, 4150.8651288816618,
     4156.4754794510754, 4162.3238561254411, 4168.4116859103087,
     4174.7404643696818, 4181.3117476418502, 4188.1271574865159,
     4195.1883789295043, 4202.4971661403742, 4210.0553393484342,
     4217.8647849951049, 4225.9274645615378, 4234.245402699562,
     4242.8207040137004, 4251.6555389916539, 4260.7521564163917,
     4270.1128800355355, 4279.7401140881984, 4289.6363342809673,
     4299.8041010093993, 4310.2460594300474, 4320.9649308485523,
     4331.963528018372, 4343.2447472063495, 4354.8115765197372,
     4366.6670901843909, 4378.8144578136371, 4391.2569466077766,
     4403.9980833237105, 4417.0406530447945, 4430.3892324930785,
     4444.0468102802761, 4458.0173252635823, 4472.304660973452,
     4486.9128064112874, 4501.8458671994904, 4517.1080693607828,
     4532.7037523909084, 4548.6373846008128, 4564.9135553708584,
     4581.5369914345383, 4598.5125425605238, 4615.8452033194144,
     4633.5401025850379, 4651.6025181765617, 4670.0378728765218,
     4688.8517422063969, 4708.0498594408118, 4727.6381150714597,
     4747.6225713498179, 4768.0094538091689, 4788.8051667146392,
     4810.0162972510261, 4831.6496114212123, 4853.7120745922894,
     4876.2108426943496, 4899.1532790227157, 4922.5469528140475,
     4946.3996525738257, 4970.7193882726087, 4995.5143973999757,
     5020.7931582779947, 5046.5643906211772, 5072.8370704807039,
     5099.6204294713052, 5126.9239735425108, 5154.7574837110769,
     5183.1310315594801, 5212.0549837365306, 5241.5400179316212,
     5271.5971246544941, 5302.2376286832377, 5333.4731937356355,
     5365.3158349901696, 5397.7779355623779, 5430.8722551852507,
     5464.6119470908443, 5499.0105679300868, 5534.0820996506527,
     5569.8409595074127, 5606.3020154339074, 5643.4806118949973,
     5681.3925740655332, 5720.0542402765841, 5759.4824716427911,
     5799.6946796245538, 5840.7088396336985, 5882.5435239469798,
     5925.2179146783583, 5968.7518347988935, 6013.1657773638726,
     6058.4809206338723, 6104.719172524874, 6151.903187082451,
     6200.0564054417737, 6249.2030836194153, 6299.3683304875631,
     6350.5781453297295, 6402.8594543945737, 6456.2401526673002,
     6510.7491480132157, 6566.4164064213292, 6623.2729977633753,
     6681.3511536539745, 6740.6843096687335, 6801.307172064342,
     6863.2557762486949, 6926.5675417079146, 6991.2813516323858,
     7057.4376134546392, 7125.0783408293037, 7194.247229991006,
     7264.9897452767336, 7337.3532089765131, 7411.3868966646924,
     7487.1421405098818, 7564.672435438084, 7644.0335520603785,
     7725.2836636206148, 7808.4834719934124, 7893.6963485514143,
     7980.9884860199008, 8070.4290496019084, 8162.0903516923017,
     8256.0480322662806, 8352.3812528944363, 8451.1729044025778,
     8552.509827261325, 8656.4830589262056, 8763.188079120986,
     8872.7250966832453, 8985.1993446470115, 9100.7213949671805,
     9219.4075141845533, 9341.3800258401207, 9466.7677274750276,
     9595.706309303785, 9728.3388445524815, 9864.8162928389575,
     10005.298054855313, 10149.952582240059, 10298.958031009566,
     10452.502987632666, 10610.787235213094, 10774.022625321288,
     10942.43399986783, 11116.260224677777, 11295.755309344751,
     11481.189640425229, 11672.85135360662, 11871.047814476602,
     12076.107296108135, 12288.380795881993, 12508.244077827076,
     12736.099929158141, 12972.380671313746, 13217.550960167133,
     13472.110932415939, 13736.599696099991, 14011.599289142061,
     14297.73911071964, 14595.700926767848, 14906.224543404176,
     15230.114230754458, 15568.246054224226, 15921.576221089133,
     16291.150657821749, 16678.116014837262, 17083.732342340085,
     17509.3877961824, 17956.61569533954, 18427.114459451652,
     18922.770965636537, 19445.688073019151, 19998.217185005295,
     20582.997023129563, 21203.000020214902, 21861.58816726178,
     22562.580710768405, 23310.336738345133]

p = np.polyfit(np.arange(len(a)), a, 6)

from pylab import *
plot(a)
plot(np.polyval(p, np.arange(len(a))))
show()

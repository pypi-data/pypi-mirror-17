

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>VirtualMicrobes.virtual_cell.Gene &mdash; Virtual Microbes Evolutionary Simulator 0.1.3 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="Virtual Microbes Evolutionary Simulator 0.1.3 documentation" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Virtual Microbes Evolutionary Simulator
          

          
          </a>

          
            
            
              <div class="version">
                0.1.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/index.html">Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">Virtual Microbes Evolutionary Simulator</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      
    <li>VirtualMicrobes.virtual_cell.Gene</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for VirtualMicrobes.virtual_cell.Gene</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">VirtualMicrobes.virtual_cell.GenomicElement</span> <span class="k">import</span> <span class="n">GenomicElement</span>
<span class="kn">from</span> <span class="nn">VirtualMicrobes.virtual_cell.Sequence</span> <span class="k">import</span> <span class="n">Operator</span><span class="p">,</span> <span class="n">BindingSequence</span>
<span class="kn">from</span> <span class="nn">VirtualMicrobes.virtual_cell.PhyloUnit</span> <span class="k">import</span> <span class="n">AddInheritanceType</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">copy</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="k">import</span> <span class="n">abstractmethod</span>
<span class="kn">import</span> <span class="nn">VirtualMicrobes.simulation.class_settings</span> <span class="k">as</span> <span class="nn">cs</span>
<span class="kn">from</span> <span class="nn">VirtualMicrobes.event.Molecule</span> <span class="k">import</span> <span class="n">MoleculeClass</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>

<div class="viewcode-block" id="randomized_param"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.randomized_param">[docs]</a><span class="k">def</span> <span class="nf">randomized_param</span><span class="p">(</span><span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_generator</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">rand_gene_params</span><span class="o">.</span><span class="n">base</span> <span class="o">**</span> <span class="n">rand_generator</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">rand_gene_params</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">rand_gene_params</span><span class="o">.</span><span class="n">upper</span><span class="p">)</span></div>

<div class="viewcode-block" id="Promoter"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.Promoter">[docs]</a><span class="k">class</span> <span class="nc">Promoter</span><span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        &quot;Private&quot; class of genes. At the moment it just encodes the basal promoter strength of genes.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">AddInheritanceType</span>
        <span class="n">__phylo_type</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">phylo_types</span><span class="p">[</span><span class="s1">&#39;Promoter&#39;</span><span class="p">]</span>
        <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;strength&#39;</span><span class="p">]</span>
        <span class="n">uid</span> <span class="o">=</span> <span class="mi">0</span>
                
        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pr_str</span><span class="p">,</span> <span class="n">time_birth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">Promoter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">time_birth</span><span class="o">=</span><span class="n">time_birth</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">strength</span> <span class="o">=</span> <span class="n">pr_str</span>
            
<div class="viewcode-block" id="Promoter.randomize"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.Promoter.randomize">[docs]</a>        <span class="k">def</span> <span class="nf">randomize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_generator</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">strength</span> <span class="o">=</span> <span class="n">randomized_param</span><span class="p">(</span><span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_generator</span><span class="o">=</span><span class="n">rand_generator</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="Promoter.mutate"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.Promoter.mutate">[docs]</a>        <span class="k">def</span> <span class="nf">mutate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mut_modifier</span><span class="p">,</span> <span class="n">rand_gen</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">strength</span> <span class="o">=</span> <span class="n">mut_modifier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strength</span><span class="p">,</span> <span class="n">rand_gen</span><span class="p">)</span></div>
        
        <span class="k">def</span> <span class="nf">_mutation_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">mutant</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Promoter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_copy</span><span class="p">(</span><span class="n">new_id</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">mutant</span><span class="o">.</span><span class="n">strength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strength</span>
            <span class="k">return</span> <span class="n">mutant</span>
        
        <span class="k">def</span> <span class="nf">_hgt_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">copied</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Promoter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_copy</span><span class="p">(</span><span class="n">new_id</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">copied</span><span class="o">.</span><span class="n">strength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strength</span>
            <span class="k">return</span> <span class="n">copied</span>
        
<div class="viewcode-block" id="Promoter.toJSON"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.Promoter.toJSON">[docs]</a>        <span class="k">def</span> <span class="nf">toJSON</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_mapper</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Promoter&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Promoter &lt;br&gt;Strength: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strength</span><span class="p">),</span>
                 <span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                 <span class="s1">&#39;colour&#39;</span><span class="p">:</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">colorConverter</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> 
                                                                                <span class="n">alpha</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strength</span><span class="o">/</span><span class="mf">10.</span><span class="p">))</span>
                 <span class="p">}</span>
            <span class="k">return</span> <span class="n">d</span> </div>
        
        <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;Prom_str:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strength</span><span class="p">)</span></div>

<span class="n">gene_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;enz&#39;</span><span class="p">,</span> <span class="s1">&#39;pump&#39;</span><span class="p">,</span> <span class="s1">&#39;tf&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="Gene"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.Gene">[docs]</a><span class="k">class</span> <span class="nc">Gene</span> <span class="p">(</span><span class="n">GenomicElement</span><span class="p">):</span>
    
    <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">,</span> <span class="s1">&#39;operator&#39;</span><span class="p">,</span> <span class="s1">&#39;is_enzyme&#39;</span><span class="p">,</span> <span class="s1">&#39;promoter&#39;</span><span class="p">]</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">,</span> <span class="n">pr_str</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> 
                 <span class="n">operator_seq_len</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">fixed_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">is_enzyme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">promoter_phylo_type</span><span class="o">=</span><span class="s1">&#39;base&#39;</span><span class="p">,</span> 
                 <span class="n">operator_phylo_type</span><span class="o">=</span><span class="s1">&#39;base&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="nb">super</span><span class="p">(</span><span class="n">Gene</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">promoter</span> <span class="o">=</span> <span class="n">Promoter</span><span class="p">(</span><span class="n">pr_str</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="c1"># also pass on kwargs to other phylo_units</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">operator</span> <span class="o">=</span> <span class="n">Operator</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="n">operator_seq_len</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;fixed_length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fixed_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_enzyme</span> <span class="o">=</span> <span class="n">is_enzyme</span>
        
    <span class="nd">@abstractmethod</span>
<div class="viewcode-block" id="Gene.randomize"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.Gene.randomize">[docs]</a>    <span class="k">def</span> <span class="nf">randomize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_gen</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="s1">&#39;randomization of the Gene&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">operator</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="n">rand_gen</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">promoter</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_gen</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">randomize_params</span><span class="p">(</span><span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_gen</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
    
    <span class="nd">@abstractmethod</span>
<div class="viewcode-block" id="Gene.randomize_params"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.Gene.randomize_params">[docs]</a>    <span class="k">def</span> <span class="nf">randomize_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_generator</span><span class="p">):</span>
        <span class="k">pass</span></div>
        
        
<div class="viewcode-block" id="Gene.mutated"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.Gene.mutated">[docs]</a>    <span class="k">def</span> <span class="nf">mutated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">new_val</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Mutates a parameter of the gene. To maintain a full ancestry, the</span>
<span class="sd">        mutation should be applied to a (shallow) copy of the gene and this copy</span>
<span class="sd">        reinserted in the original ancestral position. The shallow copy will</span>
<span class="sd">        however have a new deepcopied version of the parameter dictionary so</span>
<span class="sd">        that the mutation will not affect the ancestral gene state. </span>
<span class="sd">        </span>
<span class="sd">        :param param: parameter to mutate, where param is a dictionary key</span>
<span class="sd">        :param new_val: </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span> <span class="s2">&quot;mutating&quot;</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="s2">&quot;to:&quot;</span><span class="p">,</span> <span class="n">new_val</span>
        <span class="n">mutant</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_copy</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">)</span> <span class="c1">#handles setting the parent copy relationship </span>
        <span class="k">if</span> <span class="n">param</span> <span class="o">==</span> <span class="s2">&quot;bind&quot;</span><span class="p">:</span>
            <span class="n">mutant</span><span class="o">.</span><span class="n">binding_sequence</span> <span class="o">=</span> <span class="n">new_val</span>
        <span class="k">elif</span> <span class="n">param</span> <span class="o">==</span> <span class="s2">&quot;operator&quot;</span><span class="p">:</span>
            <span class="n">mutant</span><span class="o">.</span><span class="n">operator</span> <span class="o">=</span> <span class="n">new_val</span>
        <span class="k">elif</span> <span class="n">param</span> <span class="o">==</span> <span class="s1">&#39;promoter&#39;</span><span class="p">:</span>
            <span class="n">mutant</span><span class="o">.</span><span class="n">promoter</span> <span class="o">=</span> <span class="n">new_val</span>
        <span class="k">elif</span> <span class="n">param</span> <span class="o">==</span> <span class="s1">&#39;ligand_class&#39;</span><span class="p">:</span>
            <span class="n">mutant</span><span class="o">.</span><span class="n">ligand_class</span> <span class="o">=</span> <span class="n">new_val</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mutant</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_val</span>
        <span class="k">return</span> <span class="n">mutant</span></div>

    <span class="k">def</span> <span class="nf">_reproduction_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="n">copied</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Gene</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_reproduction_copy</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
        <span class="n">copied</span><span class="o">.</span><span class="n">is_enzyme</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_enzyme</span>
        <span class="n">copied</span><span class="o">.</span><span class="n">promoter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">promoter</span>
        <span class="c1">#NOTE: operators and binding sequences</span>
        <span class="c1"># are copied separately and linked back to genes during reproduction copy of the</span>
        <span class="c1"># complete genome. This is because ops and bss can be shared by genes and </span>
        <span class="c1"># therefore can be non-redundantly copied and mapped to genes. This does not hold</span>
        <span class="n">copied</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span>
        <span class="k">return</span> <span class="n">copied</span>
    
    <span class="k">def</span> <span class="nf">_mutation_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="n">mutant</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Gene</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_mutation_copy</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
        <span class="n">mutant</span><span class="o">.</span><span class="n">is_enzyme</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_enzyme</span>
        <span class="n">mutant</span><span class="o">.</span><span class="n">promoter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">promoter</span>
        <span class="n">mutant</span><span class="o">.</span><span class="n">operator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">operator</span>
        <span class="c1"># NOTE: operators, promoters and binding sequences can be &#39;shared&#39; by</span>
        <span class="c1"># genes after their duplication and divergence. Only when these</span>
        <span class="c1"># Sequences are themselves mutated, will a new &#39;unique&#39; Sequence object</span>
        <span class="c1"># be linked to the gene.</span>
        <span class="n">mutant</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mutant</span>
           
    <span class="k">def</span> <span class="nf">_hgt_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>       
        <span class="n">copied</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Gene</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_hgt_copy</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
        <span class="n">copied</span><span class="o">.</span><span class="n">is_enzyme</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_enzyme</span>
        <span class="n">copied</span><span class="o">.</span><span class="n">promoter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">promoter</span><span class="o">.</span><span class="n">_hgt_copy</span><span class="p">()</span>
        <span class="n">copied</span><span class="o">.</span><span class="n">operator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">operator</span><span class="o">.</span><span class="n">_hgt_copy</span><span class="p">()</span>
        <span class="c1"># NOTE: operators, promoters and binding sequences should not be shared</span>
        <span class="c1"># between the ancestral and HGT&#39;d copy of a gene. These sequences</span>
        <span class="c1"># maintain references to binding/bound ops/bss which are specific for</span>
        <span class="c1"># the genomic context, i.e. a hgt&#39;d gene loses the genomic context of</span>
        <span class="c1"># the donor cell and gains that of the acceptor.</span>
        <span class="n">copied</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">copied</span>
    
        
<div class="viewcode-block" id="Gene.toJSON"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.Gene.toJSON">[docs]</a>    <span class="k">def</span> <span class="nf">toJSON</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_mapper</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">_d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;gene_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">),</span>
             <span class="s1">&#39;description&#39;</span><span class="p">:</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>
             <span class="s1">&#39;colour&#39;</span><span class="p">:</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">attr_mapper</span><span class="o">.</span><span class="n">color_protein</span><span class="p">(</span><span class="bp">self</span><span class="p">)),</span>  
             <span class="s1">&#39;children&#39;</span><span class="p">:[</span><span class="bp">self</span><span class="o">.</span><span class="n">promoter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">operator</span><span class="p">]}</span>
        <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_d</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">_d</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
            <span class="n">_d</span><span class="p">[</span><span class="s1">&#39;children&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;children&#39;</span><span class="p">]</span> 
        <span class="k">return</span> <span class="n">_d</span> </div>
    
    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">out_str</span> <span class="o">=</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="nb">super</span><span class="p">(</span><span class="n">Gene</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__str__</span><span class="p">()</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">promoter</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span>  <span class="c1"># str(self.type)</span>
        <span class="n">out_str</span> <span class="o">+=</span> <span class="s2">&quot;operator: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">operator</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;tf&quot;</span><span class="p">:</span>
            <span class="n">out_str</span> <span class="o">+=</span> <span class="s2">&quot;bind_seq: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binding_sequence</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span>
        <span class="n">kvs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;subs_ks&quot;</span><span class="p">,</span> <span class="s2">&quot;ene_ks&quot;</span><span class="p">,</span> <span class="s2">&quot;ligand_ks&quot;</span><span class="p">]:</span>
                <span class="n">item_strs</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">mol</span><span class="p">,</span> <span class="n">const</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">item_strs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">const</span><span class="p">))</span>
                <span class="n">kvs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;: {&quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">item_strs</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">kvs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">out_str</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">kvs</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&gt;&quot;</span></div>
    
<div class="viewcode-block" id="Transporter"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.Transporter">[docs]</a><span class="k">class</span> <span class="nc">Transporter</span> <span class="p">(</span><span class="n">Gene</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    :version:</span>
<span class="sd">    :author:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;reaction&#39;</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reaction</span><span class="p">,</span> <span class="n">ene_ks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">substrates_ks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">v_max</span><span class="o">=</span><span class="mf">1.</span> <span class="p">,</span> <span class="n">exporting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> 
        <span class="nb">super</span><span class="p">(</span><span class="n">Transporter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">type_</span><span class="o">=</span><span class="s1">&#39;pump&#39;</span><span class="p">,</span> <span class="n">is_enzyme</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="n">reaction</span>
        <span class="n">substrates</span> <span class="o">=</span> <span class="p">[</span> <span class="n">sub</span><span class="o">.</span><span class="n">paired</span> <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">substrate_class</span><span class="o">.</span><span class="n">molecules</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="p">]</span>
        <span class="n">energy_sources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">energy_source_class</span><span class="o">.</span><span class="n">molecules</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>   
        <span class="k">if</span> <span class="n">ene_ks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ks_ene_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([</span> <span class="p">(</span><span class="n">ene</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span> <span class="k">for</span> <span class="n">ene</span> <span class="ow">in</span> <span class="n">energy_sources</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ks_ene_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">energy_sources</span><span class="p">,</span> <span class="n">ene_ks</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">substrates_ks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>            
            <span class="n">ks_subs_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([</span> <span class="p">(</span><span class="n">sub</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span> <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">substrates</span> <span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ks_subs_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">substrates</span><span class="p">,</span> <span class="n">substrates_ks</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;v_max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_max</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;ene_ks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ks_ene_dict</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;subs_ks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ks_subs_dict</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;exporting&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exporting</span>
        
<div class="viewcode-block" id="Transporter.randomize_params"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.Transporter.randomize_params">[docs]</a>    <span class="k">def</span> <span class="nf">randomize_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_generator</span><span class="p">,</span> <span class="n">rand_direction</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Transporter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">randomize_params</span><span class="p">(</span><span class="n">rand_gene_params</span><span class="p">,</span><span class="n">rand_generator</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;subs_ks&#39;</span><span class="p">,</span> <span class="s1">&#39;ene_ks&#39;</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">mol</span><span class="p">]</span> <span class="o">=</span> <span class="n">randomized_param</span><span class="p">(</span><span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_generator</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;v_max&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">randomized_param</span><span class="p">(</span><span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_generator</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;exporting&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">rand_direction</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rand_generator</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">])</span></div>
                
<div class="viewcode-block" id="Transporter.ode_params"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.Transporter.ode_params">[docs]</a>    <span class="k">def</span> <span class="nf">ode_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns a list of dictionaries of parameters necessary and sufficient to</span>
<span class="sd">        parameterize an ODE for all the sub-reactions associated with this Gene.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">sub_reaction_dicts</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;subs_ks&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;ene_ks&quot;</span><span class="p">]</span> </div>
    
    <span class="k">def</span> <span class="nf">_reproduction_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="n">copied</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Transporter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_reproduction_copy</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
        <span class="n">copied</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span>
        <span class="k">return</span> <span class="n">copied</span>
    
    <span class="k">def</span> <span class="nf">_mutation_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="n">mutant</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Transporter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_mutation_copy</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
        <span class="n">mutant</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span>
        <span class="k">return</span> <span class="n">mutant</span>
    
    <span class="k">def</span> <span class="nf">_hgt_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="n">copied</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Transporter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_hgt_copy</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
        <span class="n">copied</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span>
        <span class="k">return</span> <span class="n">copied</span>

<div class="viewcode-block" id="Transporter.simple_str"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.Transporter.simple_str">[docs]</a>    <span class="k">def</span> <span class="nf">simple_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="s1">&#39;e-p&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;exporting&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;i-p&#39;</span>
        <span class="k">return</span> <span class="n">p</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">substrate_class</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Transporter.toJSON"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.Transporter.toJSON">[docs]</a>    <span class="k">def</span> <span class="nf">toJSON</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1">#substrate_ks = [ {&#39;name&#39;:str(sub),   sub, ks in self[&#39;subs_ks&#39;].items() ]</span>
        <span class="n">expoimpo</span> <span class="o">=</span> <span class="s2">&quot;Exporter&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;exporting&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;Importer&quot;</span> <span class="c1"># Has to be defined here, or the condition will apply to all the rest of the description aswell :(</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Pump &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
             <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">)</span> <span class="o">+</span>
                            <span class="s1">&#39;&lt;br&gt;&#39;</span> <span class="o">+</span> <span class="n">expoimpo</span> <span class="o">+</span>
                            <span class="s1">&#39;&lt;br&gt; &lt;b&gt; Vmax: &lt;/b&gt;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;v_max&#39;</span><span class="p">])</span> <span class="o">+</span>
                            <span class="s1">&#39;&lt;br&gt; &lt;b&gt; Energy k</span><span class="se">\&#39;</span><span class="s1">s: &lt;/b&gt;&#39;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="p">[</span> <span class="nb">str</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)[:</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">mol</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ene_ks&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">]</span> <span class="p">)</span> <span class="o">+</span>
                            <span class="s1">&#39;&lt;br&gt; &lt;b&gt; Sub k</span><span class="se">\&#39;</span><span class="s1">s: &lt;/b&gt;&#39;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="p">[</span> <span class="nb">str</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)[:</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">mol</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;subs_ks&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">]</span> <span class="p">),</span> 
             <span class="s1">&#39;colour&#39;</span> <span class="p">:</span>  <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">colorConverter</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)),</span>  
             <span class="s1">&#39;children&#39;</span> <span class="p">:</span> <span class="p">[]</span> <span class="p">}</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Transporter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">toJSON</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="MetabolicGene"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.MetabolicGene">[docs]</a><span class="k">class</span> <span class="nc">MetabolicGene</span> <span class="p">(</span><span class="n">Gene</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :version:</span>
<span class="sd">    :author:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__slots__</span> <span class="o">=</span>  <span class="p">[</span><span class="s1">&#39;reaction&#39;</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reaction</span><span class="p">,</span> <span class="n">substrates_ks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">v_max</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MetabolicGene</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">type_</span><span class="o">=</span><span class="s1">&#39;enz&#39;</span><span class="p">,</span> <span class="n">is_enzyme</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="n">reaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;v_max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_max</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;subs_ks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_substrates_ks</span><span class="p">(</span><span class="n">reaction</span><span class="p">)</span> 
        
<div class="viewcode-block" id="MetabolicGene.init_substrates_ks"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.MetabolicGene.init_substrates_ks">[docs]</a>    <span class="k">def</span> <span class="nf">init_substrates_ks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reaction</span><span class="p">):</span>
        <span class="n">ks_reactants_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">reactant</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">reactants</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reactant</span><span class="p">,</span> <span class="n">MoleculeClass</span><span class="p">):</span>
                <span class="n">molecules</span> <span class="o">=</span> <span class="n">reactant</span><span class="o">.</span><span class="n">molecules</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">molecules</span><span class="p">:</span>
                    <span class="n">ks_reactants_dict</span><span class="p">[</span><span class="n">mol</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ks_reactants_dict</span><span class="p">[</span><span class="n">reactant</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.</span>
        <span class="k">return</span> <span class="n">ks_reactants_dict</span></div>
            
        
<div class="viewcode-block" id="MetabolicGene.randomize_params"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.MetabolicGene.randomize_params">[docs]</a>    <span class="k">def</span> <span class="nf">randomize_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_generator</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MetabolicGene</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">randomize_params</span><span class="p">(</span><span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_generator</span><span class="p">)</span>        
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;subs_ks&#39;</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">mol</span><span class="p">]</span> <span class="o">=</span> <span class="n">randomized_param</span><span class="p">(</span><span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_generator</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;v_max&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">randomized_param</span><span class="p">(</span><span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_generator</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="MetabolicGene.ode_params"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.MetabolicGene.ode_params">[docs]</a>    <span class="k">def</span> <span class="nf">ode_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns a list of dictionaries of parameters necessary and sufficient to</span>
<span class="sd">        parameterize an ODE for all the sub-reactions associated with this Gene.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">sub_reaction_dicts</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;subs_ks&#39;</span><span class="p">]</span> </div>
    
    <span class="k">def</span> <span class="nf">_reproduction_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="n">copied</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">MetabolicGene</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_reproduction_copy</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
        <span class="n">copied</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span>
        <span class="k">return</span> <span class="n">copied</span>
    
    <span class="k">def</span> <span class="nf">_mutation_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="n">mutant</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">MetabolicGene</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_mutation_copy</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
        <span class="n">mutant</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span>
        <span class="k">return</span> <span class="n">mutant</span>
                
    <span class="k">def</span> <span class="nf">_hgt_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="n">copied</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">MetabolicGene</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_hgt_copy</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
        <span class="n">copied</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span>
        <span class="k">return</span> <span class="n">copied</span>
    
<div class="viewcode-block" id="MetabolicGene.simple_str"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.MetabolicGene.simple_str">[docs]</a>    <span class="k">def</span> <span class="nf">simple_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="p">[</span> <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">reactants</span> <span class="p">])</span> <span class="o">+</span><span class="s1">&#39; &gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span> 
                <span class="s1">&#39;+&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="p">[</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">products</span> <span class="p">])</span>
                <span class="p">)</span></div>
        <span class="c1">#return str(&#39;enz &#39;+ &#39;&#39;.join( &#39;[&#39;+str(cl)+&#39;]&#39; for cl in self.reaction.reactants ) + </span>
        <span class="c1">#                              &#39;&gt;&#39;+ &#39;&#39;.join( &#39;[&#39;+str(cl)+&#39;]&#39; for cl in self.reaction.products ))</span>
    
<div class="viewcode-block" id="MetabolicGene.toJSON"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.MetabolicGene.toJSON">[docs]</a>    <span class="k">def</span> <span class="nf">toJSON</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1">#substrate_ks = [ {&#39;name&#39;:str(sub),   sub, ks in self[&#39;subs_ks&#39;].items() ]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Enzyme &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
             <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;b&gt; Vmax: &lt;/b&gt;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;v_max&#39;</span><span class="p">])</span> <span class="o">+</span>
                            <span class="s1">&#39;&lt;br&gt; &lt;b&gt; Sub k</span><span class="se">\&#39;</span><span class="s1">s: &lt;/b&gt;&#39;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="p">[</span> <span class="nb">str</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)[:</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">mol</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;subs_ks&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">]</span> <span class="p">)</span> <span class="o">+</span>
                            <span class="s1">&#39;&lt;br&gt;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">),</span>
             <span class="s1">&#39;colour&#39;</span><span class="p">:</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">colorConverter</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;purple&#39;</span><span class="p">)),</span> 
             <span class="s1">&#39;children&#39;</span> <span class="p">:</span> <span class="p">[]</span> <span class="p">}</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">MetabolicGene</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">toJSON</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>
    
<div class="viewcode-block" id="TranscriptionFactor"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.TranscriptionFactor">[docs]</a><span class="k">class</span> <span class="nc">TranscriptionFactor</span> <span class="p">(</span><span class="n">Gene</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :version:</span>
<span class="sd">    :author:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;binding_sequence&#39;</span><span class="p">,</span> <span class="s1">&#39;ligand_class&#39;</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ligand_mol_class</span><span class="p">,</span> <span class="n">ligand_ks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ligand_cooperativity</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
                 <span class="n">binding_seq_len</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">eff_apo</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">eff_bound</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">k_bind_op</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> 
                 <span class="n">binding_cooperativity</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sense_external</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TranscriptionFactor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">type_</span><span class="o">=</span><span class="s1">&#39;tf&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binding_sequence</span> <span class="o">=</span> <span class="n">BindingSequence</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="n">binding_seq_len</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ligand_class</span> <span class="o">=</span> <span class="n">ligand_mol_class</span>
        <span class="k">if</span> <span class="n">ligand_ks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>            
            <span class="n">ligands_ks_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([</span> <span class="p">(</span><span class="n">ligand</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span> <span class="k">for</span> <span class="n">ligand</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ligand_class</span><span class="o">.</span><span class="n">molecules</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>  <span class="p">])</span>    
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ligands_ks_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ligand_class</span><span class="o">.</span><span class="n">molecules</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">ligand_ks</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;ligand_ks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ligands_ks_dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ligand_coop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ligand_cooperativity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;eff_apo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eff_apo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;eff_bound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eff_bound</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;k_bind_op&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_bind_op</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;binding_coop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">binding_cooperativity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;sense_external&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sense_external</span>
        
<div class="viewcode-block" id="TranscriptionFactor.randomize_params"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.TranscriptionFactor.randomize_params">[docs]</a>    <span class="k">def</span> <span class="nf">randomize_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_generator</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TranscriptionFactor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">randomize_params</span><span class="p">(</span><span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_generator</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ligand_ks&#39;</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">ligand</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">ligand</span><span class="p">]</span> <span class="o">=</span> <span class="n">randomized_param</span><span class="p">(</span><span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_generator</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;eff_apo&#39;</span><span class="p">,</span> <span class="s1">&#39;eff_bound&#39;</span><span class="p">,</span> <span class="s1">&#39;k_bind_op&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">randomized_param</span><span class="p">(</span><span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_generator</span><span class="p">)</span></div>
                
<div class="viewcode-block" id="TranscriptionFactor.randomize"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.TranscriptionFactor.randomize">[docs]</a>    <span class="k">def</span> <span class="nf">randomize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_gen</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TranscriptionFactor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_gen</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binding_sequence</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="n">rand_gen</span><span class="p">)</span></div>
        
    <span class="k">def</span> <span class="nf">_reproduction_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="n">copied</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">TranscriptionFactor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_reproduction_copy</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
        <span class="n">copied</span><span class="o">.</span><span class="n">ligand_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ligand_class</span>
        <span class="k">return</span> <span class="n">copied</span>
    
    <span class="k">def</span> <span class="nf">_mutation_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="n">mutant</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">TranscriptionFactor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_mutation_copy</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
        <span class="n">mutant</span><span class="o">.</span><span class="n">ligand_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ligand_class</span>
        <span class="n">mutant</span><span class="o">.</span><span class="n">binding_sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binding_sequence</span>
        <span class="k">return</span> <span class="n">mutant</span>
    
    <span class="k">def</span> <span class="nf">_hgt_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="n">copied</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">TranscriptionFactor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_hgt_copy</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
        <span class="n">copied</span><span class="o">.</span><span class="n">ligand_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ligand_class</span>
        <span class="n">copied</span><span class="o">.</span><span class="n">binding_sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binding_sequence</span><span class="o">.</span><span class="n">_hgt_copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">copied</span>
    
<div class="viewcode-block" id="TranscriptionFactor.simple_str"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.TranscriptionFactor.simple_str">[docs]</a>    <span class="k">def</span> <span class="nf">simple_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;tf &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">ligand_class</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;sense_external&#39;</span><span class="p">]:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;-e&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;-i&#39;</span>
        <span class="k">return</span> <span class="n">s</span></div>
    
<div class="viewcode-block" id="TranscriptionFactor.toJSON"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.TranscriptionFactor.toJSON">[docs]</a>    <span class="k">def</span> <span class="nf">toJSON</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1">#print &#39;,&#39;.join( [ str(mol.name)+&#39;:&#39;+str(k) for mol,k in self.params[&#39;ligand_ks&#39;] ] )</span>
        <span class="c1">#substrate_ks = [ {&#39;name&#39;:str(sub),   sub, ks in self[&#39;subs_ks&#39;].items() ]</span>
        <span class="n">sense</span> <span class="o">=</span> <span class="s1">&#39;-e&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;sense_external&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;-i&#39;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;TF &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="o">+</span> <span class="n">sense</span><span class="p">,</span>
             <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;BS: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">binding_sequence</span><span class="o">.</span><span class="n">sequence</span> <span class="o">+</span>  
                            <span class="s1">&#39;&lt;br&gt;&lt;b&gt;Ligand:&lt;/b&gt; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ligand_class</span><span class="p">)</span> <span class="o">+</span> 
                            <span class="s1">&#39;&lt;br&gt;&lt;b&gt;APO: &lt;/b&gt;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;eff_apo&#39;</span><span class="p">])</span> <span class="o">+</span> 
                            <span class="s1">&#39;&lt;br&gt;&lt;b&gt;Bound: &lt;/b&gt;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;eff_bound&#39;</span><span class="p">])</span> <span class="o">+</span>
                            <span class="s1">&#39;&lt;br&gt;&lt;b&gt; Ligand k</span><span class="se">\&#39;</span><span class="s1">s: &lt;/b&gt;&#39;</span> <span class="o">+</span>
                            <span class="s1">&#39;&lt;br&gt;&#39;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="p">[</span> <span class="nb">str</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)[:</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">mol</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ligand_ks&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">]</span> <span class="p">),</span>
             <span class="s1">&#39;colour&#39;</span><span class="p">:</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">colorConverter</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;brown&#39;</span><span class="p">)),</span> 
             <span class="s1">&#39;children&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">binding_sequence</span><span class="p">]}</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">TranscriptionFactor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">toJSON</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>
    
<div class="viewcode-block" id="random_gene"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.random_gene">[docs]</a><span class="k">def</span> <span class="nf">random_gene</span><span class="p">(</span><span class="n">environment</span><span class="p">,</span> <span class="n">rand_gene_params</span><span class="p">,</span> <span class="n">rand_gen</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">keep_transport_direction</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">gene_type</span> <span class="o">=</span> <span class="n">rand_gen</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">gene_types</span><span class="p">)</span>
    <span class="n">gene</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">gene_type</span> <span class="o">==</span> <span class="s1">&#39;enz&#39;</span><span class="p">:</span>
        <span class="n">conversion</span> <span class="o">=</span> <span class="n">rand_gen</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">environment</span><span class="o">.</span><span class="n">conversions</span><span class="p">)</span>
        <span class="n">gene</span> <span class="o">=</span> <span class="n">MetabolicGene</span><span class="p">(</span><span class="n">reaction</span><span class="o">=</span><span class="n">conversion</span><span class="p">,</span> <span class="n">operator_seq_len</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">operator_seq_len</span><span class="p">)</span>
        <span class="n">gene</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="n">rand_gene_params</span><span class="p">,</span><span class="n">rand_gen</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">gene_type</span> <span class="o">==</span> <span class="s1">&#39;pump&#39;</span><span class="p">:</span>
        <span class="n">transport</span> <span class="o">=</span> <span class="n">rand_gen</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">environment</span><span class="o">.</span><span class="n">transports</span><span class="p">)</span>
        <span class="n">gene</span> <span class="o">=</span> <span class="n">Transporter</span><span class="p">(</span><span class="n">reaction</span><span class="o">=</span><span class="n">transport</span><span class="p">,</span> <span class="n">operator_seq_len</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">operator_seq_len</span><span class="p">)</span>
        <span class="n">rand_direction</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">keep_transport_direction</span> <span class="k">else</span> <span class="kc">True</span>
        <span class="n">gene</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="n">rand_gene_params</span><span class="p">,</span><span class="n">rand_gen</span><span class="p">,</span> <span class="n">rand_direction</span><span class="o">=</span><span class="n">rand_direction</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">gene_type</span> <span class="o">==</span> <span class="s1">&#39;tf&#39;</span><span class="p">:</span>
        <span class="n">ligand_class</span> <span class="o">=</span> <span class="n">rand_gen</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">environment</span><span class="o">.</span><span class="n">molecule_classes</span><span class="p">)</span>
        <span class="n">gene</span> <span class="o">=</span> <span class="n">TranscriptionFactor</span><span class="p">(</span><span class="n">ligand_mol_class</span><span class="o">=</span><span class="n">ligand_class</span><span class="p">,</span>
                                   <span class="n">ligand_cooperativity</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">ligand_binding_cooperativity</span><span class="p">,</span>
                                   <span class="n">operator_seq_len</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">operator_seq_len</span><span class="p">,</span>
                                   <span class="n">binding_seq_len</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">binding_seq_len</span><span class="p">,</span>
                                   <span class="n">binding_cooperativity</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">tf_binding_cooperativity</span><span class="p">)</span>
        <span class="n">gene</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="n">rand_gene_params</span><span class="p">,</span><span class="n">rand_gen</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gene</span></div>

<div class="viewcode-block" id="pump_rates"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.pump_rates">[docs]</a><span class="k">def</span> <span class="nf">pump_rates</span><span class="p">(</span><span class="n">pump</span><span class="p">,</span> <span class="n">pump_conc</span><span class="p">,</span> <span class="n">metabolite_conc_dict</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Estimate of pumping rates for each substrate</span>
<span class="sd">    </span>
<span class="sd">    :param pump: pump gene</span>
<span class="sd">    :param pump_conc: internal pump concentration</span>
<span class="sd">    :param metabolite_conc_dict: concentrations of metabolites</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">metabolite_rate_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span> <span class="c1"># NOTE: unordered ok</span>
    <span class="n">sub_reactions</span><span class="p">,</span> <span class="n">subs_kss</span><span class="p">,</span> <span class="n">ene_kss</span> <span class="o">=</span> <span class="n">pump</span><span class="o">.</span><span class="n">ode_params</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">sub_reaction_params</span> <span class="ow">in</span> <span class="n">sub_reactions</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pump</span><span class="o">.</span><span class="n">exporting</span><span class="p">:</span>
            <span class="n">sub</span> <span class="o">=</span> <span class="n">sub_reaction_params</span><span class="p">[</span><span class="s1">&#39;products&#39;</span><span class="p">][</span><span class="s1">&#39;substrate&#39;</span><span class="p">][</span><span class="s1">&#39;mol&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sub</span> <span class="o">=</span> <span class="n">sub_reaction_params</span><span class="p">[</span><span class="s1">&#39;reactants&#39;</span><span class="p">][</span><span class="s1">&#39;substrate&#39;</span><span class="p">][</span><span class="s1">&#39;mol&#39;</span><span class="p">]</span>
        <span class="n">sub_conc</span> <span class="o">=</span>  <span class="n">metabolite_conc_dict</span><span class="p">[</span><span class="n">sub</span><span class="p">]</span>
        <span class="n">_sub_stoi</span> <span class="o">=</span> <span class="n">sub_reaction_params</span><span class="p">[</span><span class="s1">&#39;reactants&#39;</span><span class="p">][</span><span class="s1">&#39;substrate&#39;</span><span class="p">][</span><span class="s1">&#39;stoi&#39;</span><span class="p">]</span>
        <span class="n">sub_k_bind</span> <span class="o">=</span> <span class="n">subs_kss</span><span class="p">[</span><span class="n">sub</span><span class="p">]</span>
        <span class="n">ene_mol</span> <span class="o">=</span> <span class="n">sub_reaction_params</span><span class="p">[</span><span class="s1">&#39;reactants&#39;</span><span class="p">][</span><span class="s1">&#39;energy&#39;</span><span class="p">][</span><span class="s1">&#39;mol&#39;</span><span class="p">]</span>
        <span class="n">ene_conc</span> <span class="o">=</span>  <span class="n">metabolite_conc_dict</span><span class="p">[</span><span class="n">ene_mol</span><span class="p">]</span>
        <span class="n">_ene_stoi</span> <span class="o">=</span> <span class="n">sub_reaction_params</span><span class="p">[</span><span class="s1">&#39;reactants&#39;</span><span class="p">][</span><span class="s1">&#39;energy&#39;</span><span class="p">][</span><span class="s1">&#39;stoi&#39;</span><span class="p">]</span>
        <span class="n">ene_k_bind</span> <span class="o">=</span> <span class="n">ene_kss</span><span class="p">[</span><span class="n">ene_mol</span><span class="p">]</span>
        <span class="n">rate</span> <span class="o">=</span> <span class="n">pump_conc</span> <span class="o">*</span> <span class="n">pump</span><span class="p">[</span><span class="s1">&#39;v_max&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">sub_conc</span> <span class="o">*</span> <span class="n">ene_conc</span> <span class="o">/</span> <span class="p">((</span><span class="n">sub_conc</span> <span class="o">+</span> <span class="n">sub_k_bind</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ene_conc</span> <span class="o">+</span> <span class="n">ene_k_bind</span><span class="p">))</span>
        <span class="n">metabolite_rate_dict</span><span class="p">[</span><span class="n">sub</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">rate</span> <span class="k">if</span> <span class="n">pump</span><span class="o">.</span><span class="n">exporting</span> <span class="k">else</span> <span class="n">rate</span>
    <span class="k">return</span> <span class="n">metabolite_rate_dict</span></div>

<div class="viewcode-block" id="convert_rates"><a class="viewcode-back" href="../../../reference/VirtualMicrobes.virtual_cell.html#VirtualMicrobes.virtual_cell.Gene.convert_rates">[docs]</a><span class="k">def</span> <span class="nf">convert_rates</span><span class="p">(</span><span class="n">enzyme</span><span class="p">,</span> <span class="n">enzyme_conc</span><span class="p">,</span> <span class="n">metabolite_conc_dict</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Estimate of conversion rates per substrate</span>
<span class="sd">    </span>
<span class="sd">    :param enzyme: enzyme gene</span>
<span class="sd">    :param enzyme_conc: internal enzyme concentrations</span>
<span class="sd">    :param metabolite_conc_dict: concentrations of metabolites</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">metabolite_rate_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span> <span class="c1"># NOTE: unordered ok</span>
    <span class="k">for</span> <span class="n">sub_reaction_params</span> <span class="ow">in</span> <span class="n">enzyme</span><span class="o">.</span><span class="n">ode_params</span><span class="p">():</span>
        <span class="n">nume</span> <span class="o">=</span> <span class="n">enzyme</span><span class="p">[</span><span class="s1">&#39;v_max&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">enzyme_conc</span>
        <span class="n">denom</span> <span class="o">=</span> <span class="mf">1.</span> 
        <span class="k">for</span> <span class="n">reac_dict</span> <span class="ow">in</span> <span class="n">sub_reaction_params</span><span class="p">[</span><span class="s1">&#39;reactants&#39;</span><span class="p">]:</span>
            <span class="n">reac</span> <span class="o">=</span> <span class="n">reac_dict</span><span class="p">[</span><span class="s1">&#39;mol&#39;</span><span class="p">]</span> 
            <span class="n">re_stoi</span> <span class="o">=</span> <span class="n">reac_dict</span><span class="p">[</span><span class="s1">&#39;stoi&#39;</span><span class="p">]</span>
            <span class="n">re_k_bind</span> <span class="o">=</span> <span class="n">reac_dict</span><span class="p">[</span><span class="s1">&#39;k_bind&#39;</span><span class="p">]</span>
            <span class="n">nume</span> <span class="o">*=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">metabolite_conc_dict</span><span class="p">[</span><span class="n">reac</span><span class="p">],</span> <span class="n">re_stoi</span><span class="p">)</span>
            <span class="n">denom</span> <span class="o">*=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">metabolite_conc_dict</span><span class="p">[</span><span class="n">reac</span><span class="p">]</span> <span class="o">+</span> <span class="n">re_k_bind</span><span class="p">,</span> <span class="n">re_stoi</span><span class="p">)</span>
        <span class="n">rate</span> <span class="o">=</span> <span class="n">nume</span> <span class="o">/</span> <span class="n">denom</span>
        <span class="k">for</span> <span class="n">reac_dict</span> <span class="ow">in</span> <span class="n">sub_reaction_params</span><span class="p">[</span><span class="s1">&#39;reactants&#39;</span><span class="p">]:</span>
            <span class="n">reac</span> <span class="o">=</span> <span class="n">reac_dict</span><span class="p">[</span><span class="s1">&#39;mol&#39;</span><span class="p">]</span> 
            <span class="n">re_stoi</span> <span class="o">=</span> <span class="n">reac_dict</span><span class="p">[</span><span class="s1">&#39;stoi&#39;</span><span class="p">]</span>
            <span class="n">metabolite_rate_dict</span><span class="p">[</span><span class="n">reac</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">rate</span> <span class="o">*</span> <span class="n">re_stoi</span>
        <span class="k">for</span> <span class="n">prod_dict</span> <span class="ow">in</span> <span class="n">sub_reaction_params</span><span class="p">[</span><span class="s1">&#39;products&#39;</span><span class="p">]:</span>
            <span class="n">prod</span> <span class="o">=</span> <span class="n">prod_dict</span><span class="p">[</span><span class="s1">&#39;mol&#39;</span><span class="p">]</span>
            <span class="n">prod_stoi</span> <span class="o">=</span> <span class="n">prod_dict</span><span class="p">[</span><span class="s1">&#39;stoi&#39;</span><span class="p">]</span>
            <span class="n">metabolite_rate_dict</span><span class="p">[</span><span class="n">prod</span><span class="p">]</span> <span class="o">=</span> <span class="n">rate</span> <span class="o">*</span> <span class="n">prod_stoi</span>
    <span class="k">return</span> <span class="n">metabolite_rate_dict</span></div>
    
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Thomas Cuypers, Bram van Dijk.
      Last updated on Oct 10, 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'0.1.3',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
# PRECIS test cases
# UTF-8 encoding
#
# Each command is on a separate line. Arguments are separated by spaces.
#
#  PROFILE profile
#  ALLOW input [output]
#  DISALLOW input reason
#
# If the output argument is omitted to ALLOW, the output must equal the input.
#
# Python3 unicode escapes are supported. For example, use \x20 for spaces.


PROFILE UsernameCasePreserved

# Edge cases

ALLOW     \\
DISALLOW  \x00           DISALLOWED/controls
DISALLOW  \x09           DISALLOWED/controls
DISALLOW  \x0A           DISALLOWED/controls
DISALLOW  \x0D           DISALLOWED/controls
DISALLOW  \x1F           DISALLOWED/controls
DISALLOW  \x20           FREE_PVAL/spaces
ALLOW     \x21
ALLOW     \x7E
DISALLOW  \x7F           DISALLOWED/controls
DISALLOW  \x80           DISALLOWED/controls
DISALLOW  \x9F           DISALLOWED/controls
DISALLOW  \xA0           FREE_PVAL/has_compat
ALLOW     \xFE
ALLOW     \xFF
DISALLOW  \uFEFF         DISALLOWED/precis_ignorable_properties
DISALLOW  \uFFFE         DISALLOWED/precis_ignorable_properties
DISALLOW  \U0010FFFF     DISALLOWED/precis_ignorable_properties

# Kevin

ALLOW   Kevin      
ALLOW   \u212Aevin  Kevin
ALLOW   \u039Aevin 
ALLOW   \u1E32evin 
ALLOW   \u1E34evin 
ALLOW   K\u0301evin    \u1e30evin
ALLOW   K\u0301\u0301evin    \u1e30\u0301evin
ALLOW   K\ua717evin
DISALLOW   \u24C0evin   FREE_PVAL/has_compat
ALLOW    \u2C69evin 
ALLOW    \uA740evin
ALLOW    \uA742evin
ALLOW    \uA744evin
ALLOW    \uA7A2evin
ALLOW    \uFF2Bevin        Kevin
DISALLOW  \U000E004Bevin     DISALLOWED/precis_ignorable_properties
DISALLOW  \U0001F11Aevin     FREE_PVAL/has_compat
DISALLOW  \U0001F13Aevin     FREE_PVAL/has_compat
DISALLOW  \U0001F15Aevin     FREE_PVAL/symbols
DISALLOW  \U0001F17Aevin     FREE_PVAL/symbols


# Examples from RFC 7564

ALLOW  StPeter
ALLOW  Juliet
ALLOW  Juliet@Example.COM
ALLOW  Fussball
ALLOW  Fußball
ALLOW  π
ALLOW  Σ
ALLOW  σ
ALLOW  ς
ALLOW  ju1iet
ALLOW  \u13DA\u13A2\u13B5\u13AC\u13A2\u13AC\u13D2

# RFC 6452: Derived property changed in 6.0.

ALLOW  \u0CF1
ALLOW  \u0CF2
DISALLOW  \u19DA    FREE_PVAL/other_letter_digits

# "dotless i" in several Turkic languages (SpecialCasing.txt)
# TODO

ALLOW  ~`!@#$%^&*()-_=+[{}]\\|;:'",<.>/?
ALLOW  A\uA717
ALLOW  é
ALLOW  é́́  é́́
ALLOW  é    é
ALLOW  o
ALLOW  ο
ALLOW  о
DISALLOW  ﻉ   FREE_PVAL/has_compat
DISALLOW  ﻊ   FREE_PVAL/has_compat
DISALLOW  ﻋ   FREE_PVAL/has_compat
DISALLOW  ﻌ   FREE_PVAL/has_compat
ALLOW  ｶ  カ
ALLOW  カ

DISALLOW  ㌀   FREE_PVAL/has_compat
ALLOW    アパート

DISALLOW i⁹   FREE_PVAL/has_compat
DISALLOW  ¼   FREE_PVAL/has_compat

DISALLOW  ǆ    FREE_PVAL/has_compat
DISALLOW  ︷   FREE_PVAL/has_compat

DISALLOW  ℌ   FREE_PVAL/has_compat
DISALLOW  ℍ    FREE_PVAL/has_compat

ALLOW   \u2e2f

# FCE -> ASCII

ALLOW  \u037e   ;
ALLOW  \u1fef   `
ALLOW  \u212a   K


# Full-width characters

ALLOW  ！            !
ALLOW  Ｊｕｌｉｅｔ   Juliet
ALLOW  \uff04        $
DISALLOW \ufe69     FREE_PVAL/has_compat

ALLOW  \u0052\u0073
DISALLOW \u20a8     FREE_PVAL/has_compat

# Regional Indicator Symbols (Flags)

DISALLOW  🇺🇸    FREE_PVAL/symbols


# Look-alikes

ALLOW  K
ALLOW  K  K
DISALLOW Ⓚ     FREE_PVAL/has_compat
DISALLOW  ①       FREE_PVAL/has_compat

ALLOW  Ω
ALLOW  Ω  Ω

ALLOW  Ç
ALLOW  Ç  Ç

ALLOW  q̣̇   q̣̇
ALLOW  q̣̇

ALLOW  가
ALLOW  가   가

ALLOW  Ω
ALLOW  Ω

ALLOW  Å   Å
ALLOW  Ω   Ω
ALLOW  Å  Å
ALLOW  ṩ  ṩ
DISALLOW  ﬁ       FREE_PVAL/has_compat

ALLOW  각
ALLOW  각   각

DISALLOW 👾   FREE_PVAL/symbols
DISALLOW 💚   FREE_PVAL/symbols

ALLOW \u2126   \u03a9

# Zalgo Text

ALLOW  Z̴̙̤̞͉͚̯̞̠͍͑ͫ̓ͪ̂ͫ̽  Z̴̙̤̞͉͚̯̞̠͍͑ͫ̓ͪ̂ͫ̽

ALLOW  Z̴̙̤̞͉͚̯̞̠͍͑ͫ̓ͪ̂ͫ̽A̴̵̜̰͔ͫ͗͢L̠ͨͧͩ͘G̴̻͈͍͔̹̑͗̎̅͛́Ǫ̵̹̻̝̳͂̌̌͘!͖̬̰̙̗̿̋ͥͥ̂ͣ̐́́͜͞   Z̴̙̤̞͉͚̯̞̠͍͑ͫ̓ͪ̂ͫ̽A̴̵̜̰͔ͫ͗͢L̠ͨͧͩ͘G̴̻͈͍͔̹̑͗̎̅͛́Ǫ̵̹̻̝̳͂̌̌͘!͖̬̰̙̗̿̋ͥͥ̂ͣ̐́́͜͞

DISALLOW  Z͑ͫ̓ͪ̂ͫ̽͏̴̙̤̞͉͚̯̞̠͍A̴̵̜̰͔ͫ͗͢L̠ͨͧͩ͘G̴̻͈͍͔̹̑͗̎̅͛́Ǫ̵̹̻̝̳͂̌̌͘!͖̬̰̙̗̿̋ͥͥ̂ͣ̐́́͜͞   DISALLOWED/precis_ignorable_properties

ALLOW Z̴̢̭̦̙̘̘̤͇̠̓̌͛͐̆̑̇͂͌̕A̴̧̝̝͖̬̩̯̿̑̉̈̂̈͌͜Ļ̛̬̖̰̫̼̩͖͊̔̇͒͒̉͢͟G̶̝̞̼̝͍̽̇͐̓̌͂̓͠͝O̡̫̯̠͈̯͖̺̿̈͛̆̏͋͂  Z̴̢̭̦̙̘̘̤͇̠̓̌͛͐̆̑̇͂͌̕A̴̧̝̝͖̬̩̯̿̑̉̈̂̈͌͜Ļ̛̬̖̰̫̼̩͖͊̔̇͒͒̉͢͟G̶̝̞̼̝͍̽̇͐̓̌͂̓͠͝O̡̫̯̠͈̯͖̺̿̈͛̆̏͋͂



# Allowed "has_compat" characters (due to NFC)

ALLOW \u037e  ;

ALLOW \u0340\u0341\u0343\u0344\u0374\u037e\u0958\u0959\u095a\u095b\u095c\u095d\u095e\u095f\u09dc\u09dd\u09df\u0a33\u0a36\u0a59\u0a5a\u0a5b\u0a5e\u0b5c\u0b5d\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f73\u0f75\u0f76\u0f78\u0f81\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fef\u1ff9\u1ffb\u2126\u212a\u212b   \u0300\u0301\u0313\u0308\u0301\u02b9;\u0915\u093c\u0916\u093c\u0917\u093c\u091c\u093c\u0921\u093c\u0922\u093c\u092b\u093c\u092f\u093c\u09a1\u09bc\u09a2\u09bc\u09af\u09bc\u0a32\u0a3c\u0a38\u0a3c\u0a16\u0a3c\u0a17\u0a3c\u0a1c\u0a3c\u0a2b\u0a3c\u0b21\u0b3c\u0b22\u0b3c\u0f42\u0fb7\u0f4c\u0fb7\u0f51\u0fb7\u0f56\u0fb7\u0f5b\u0fb7\u0f40\u0fb5\u0f71\u0f71\u0f72\u0f74\u0fb2\u0f80\u0fb3\u0f71\u0f80\u0f80\u0f92\u0fb7\u0f9c\u0fb7\u0fa1\u0fb7\u0fa6\u0fb7\u0fab\u0fb7\u0f90\u0fb5\u03ac\u03ad\u03ae\u03af\u03cc\u03cd\u03ce\u0386\u03b9\u0388\u0389\u0390\u038a\u03b0\u038e`\u038c\u038f\u03a9K\u00c5

# "mapped to nothing" https://tools.ietf.org/html/rfc3454#appendix-B.1

DISALLOW \u00AD  DISALLOWED/precis_ignorable_properties
DISALLOW \u034F  DISALLOWED/precis_ignorable_properties
DISALLOW \u1806  FREE_PVAL/punctuation
DISALLOW \u180B  DISALLOWED/precis_ignorable_properties
DISALLOW \u180C  DISALLOWED/precis_ignorable_properties
DISALLOW \u180D  DISALLOWED/precis_ignorable_properties
DISALLOW \u200B  DISALLOWED/precis_ignorable_properties
DISALLOW \u200C  CONTEXTJ/join_control
DISALLOW \u200D  CONTEXTJ/join_control
DISALLOW \u2060  DISALLOWED/precis_ignorable_properties
DISALLOW \uFE00  DISALLOWED/precis_ignorable_properties
DISALLOW \uFE01  DISALLOWED/precis_ignorable_properties
DISALLOW \uFE02  DISALLOWED/precis_ignorable_properties
DISALLOW \uFE03  DISALLOWED/precis_ignorable_properties
DISALLOW \uFE04  DISALLOWED/precis_ignorable_properties
DISALLOW \uFE05  DISALLOWED/precis_ignorable_properties
DISALLOW \uFE06  DISALLOWED/precis_ignorable_properties
DISALLOW \uFE07  DISALLOWED/precis_ignorable_properties
DISALLOW \uFE08  DISALLOWED/precis_ignorable_properties
DISALLOW \uFE09  DISALLOWED/precis_ignorable_properties
DISALLOW \uFE0A  DISALLOWED/precis_ignorable_properties
DISALLOW \uFE0B  DISALLOWED/precis_ignorable_properties
DISALLOW \uFE0C  DISALLOWED/precis_ignorable_properties
DISALLOW \uFE0D  DISALLOWED/precis_ignorable_properties
DISALLOW \uFE0E  DISALLOWED/precis_ignorable_properties
DISALLOW \uFE0F  DISALLOWED/precis_ignorable_properties
DISALLOW \uFEFF  DISALLOWED/precis_ignorable_properties

# Username Spaces

DISALLOW  'Juliet\x20Capulet'       FREE_PVAL/spaces
DISALLOW  '\x20Juliet'              FREE_PVAL/spaces
DISALLOW  'Juliet\x20'             FREE_PVAL/spaces
DISALLOW  'Juliet\x20\x20Capulet'   FREE_PVAL/spaces

# Bidirectional text

ALLOW     \u05d0\u05d1
ALLOW     \u05d0\u20d6\u05d1
# This test fails on systems before Unicode 7.0; U+1AB6 was introduced in 7.0.
# ALLOW     \u05d0\u1ab6\u05d1
DISALLOW  \u05d0\u05d1+      bidi rule
DISALLOW  +\u05d0\u05d1      bidi rule
DISALLOW  A\u05d0\u05d1      bidi rule
DISALLOW  \u05d0\u05d1A      bidi rule
DISALLOW  \u05d0A\u05d1      bidi rule

# When rendered RTL, parens are mirrored but not solidus (on my mac).
ALLOW     \u05d0(/%\\))\u05d1

# Only apply bidi rule for strings with RTL codepoints.

ALLOW    Juliet+
ALLOW   +Juliet
DISALLOW  Juliet\u05d1       bidi rule


# More examples:

ALLOW   !
ALLOW   ~



PROFILE UsernameCaseMapped

# Examples from RFC 7564

ALLOW  Juliet  juliet
ALLOW  Juliet@Example.COM  juliet@example.com
ALLOW  Fussball  fussball
ALLOW  Fußball   fussball
ALLOW  π
ALLOW  Σ  σ
ALLOW  σ
ALLOW  ς  σ

ALLOW  ~`!@#$%^&*()-_=+[{}]\\|;:'",<.>/?
ALLOW  é
ALLOW  é́́  é́́
ALLOW  é    é

# Full-width characters

ALLOW  ！            !
ALLOW  Ｊｕｌｉｅｔ   juliet

# Regional Indicator Symbols (Flags)

DISALLOW  🇺🇸   FREE_PVAL/symbols

# Look-alikes

ALLOW  K  k
ALLOW  K  k

ALLOW  Ω  ω
ALLOW  Ω  ω
